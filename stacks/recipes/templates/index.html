<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>{{site_name}} · {{site_tagline}}</title>
  <link rel="stylesheet" href="assets/styles.css">
</head>
<body>
  <header class="hero">
    <div class="container hero__content">
      <div class="hero__intro">
        <p class="eyebrow">Recipe Collection</p>
        <h1>{{site_name}}</h1>
        <p class="tagline">{{site_tagline}}</p>
        <div class="hero__meta">
          <span class="pill">Curated by {{author}}</span>
          <span class="pill pill--ghost">{{length (values objects)}} recipes</span>
        </div>
      </div>
      <div class="hero__stats">
        <div class="stat">
          <p class="stat__label">Recipes</p>
          <p class="stat__value">{{length (values objects)}}</p>
        </div>
        <div class="stat">
          <p class="stat__label">Tags</p>
          <p class="stat__value">{{length (group_by (values objects) "properties.tags")}}</p>
        </div>
        <div class="stat">
          <p class="stat__label">Difficulties</p>
          <p class="stat__value">{{length (group_by (values objects) "properties.difficulty")}}</p>
        </div>
      </div>
    </div>
  </header>

  <main class="content container">
    <section class="grid card-grid">
      {{#each (values objects)}}
        {{#if (inherits (lookup this "class") "recipe" @root.classesById)}}
          <article class="card">
           {{#with (lookup this "properties") as |props|}}
             <div class="card__header">
               <p class="pill pill--ghost">{{lookup ../this "class"}}</p>
                <p class="pill pill--accent"><a class="pill-link" href="difficulty/{{lookup props "difficulty"}}.html">{{lookup props "difficulty"}}</a></p>
             </div>
             <h2 class="card__title">{{lookup props "title"}}</h2>
             <ul class="meta-grid">
               <li><span>Serves</span><strong>{{lookup props "servings"}}</strong></li>
               <li><span>Prep</span><strong>{{lookup props "prep_time_minutes"}} min</strong></li>
               <li><span>Cook</span><strong>{{lookup props "cook_time_minutes"}} min</strong></li>
             </ul>
             <div class="tags">
               {{#each (lookup props "tags")}}
                  <a class="tag" href="tags/{{this}}.html">{{this}}</a>
                {{/each}}
              </div>
              <a class="button button--block" href="recipes/{{#if (lookup props "slug")}}{{lookup props "slug"}}{{else}}{{lookup ../this "id"}}{{/if}}.html">View recipe</a>
            {{/with}}
          </article>
        {{/if}}
      {{/each}}
    </section>

    <section class="panel">
      <div class="panel__header">
        <h2>Browse by Tag</h2>
        <p class="muted">Jump straight into what you are craving.</p>
      </div>
      <div class="tag-cloud">
        {{#each (group_by (values objects) "properties.tags")}}
        <a class="tag tag--cta" href="tags/{{identity key}}.html">{{identity key}} ({{length items}})</a>
        {{/each}}
      </div>
    </section>

    <section class="panel">
      <div class="panel__header">
        <h2>Browse by Difficulty</h2>
        <p class="muted">Find the right challenge for tonight.</p>
      </div>
      <div class="tag-cloud">
        {{#each (group_by (values objects) "properties.difficulty")}}
          <a class="tag tag--cta" href="difficulty/{{identity key}}.html">{{identity key}} ({{length items}})</a>
        {{/each}}
      </div>
    </section>

    {{!-- Generate tag pages --}}
    {{#each (group_by (values objects) "properties.tags")}}
      {{#file (concat "tags/" key ".html") group=this}}
{{> tags/tag}}
      {{/file}}
    {{/each}}

    {{!-- Generate difficulty pages --}}
    {{#each (group_by (values objects) "properties.difficulty")}}
      {{#file (concat "difficulty/" key ".html") level=key entries=items}}
{{> difficulty/difficulty}}
      {{/file}}
    {{/each}}
  </main>

  <footer class="footer">
    <p>Made with Terrible · {{site_name}}</p>
  </footer>
</body>
</html>
